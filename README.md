# Информационная система «Аукционы»

## Описание проекта

Информационная система «Аукционы» разработана для аукционной фирмы, специализирующейся на продаже антикварных вещей и произведений искусства. [cite: 1] Система автоматизирует ключевые процессы, связанные с организацией и проведением аукционов, включая управление лотами, участниками (продавцами и покупателями) и результатами торгов.

Основная задача — предоставить удобный и эффективный инструмент для всех участников аукционного процесса.

## Основные функции

* **Управление аукционами:**
    * Создание, редактирование и удаление аукционов (информация о дате, времени, месте, специфике). [cite: 4]
    * Управление статусами аукционов ("Запланирован", "Идет торг", "Завершен").
* **Управление лотами:**
    * Добавление лотов к аукционам с указанием номера, продавца, начальной цены и описания. [cite: 3, 5]
    * Удаление лотов из запланированных аукционов. [cite: 13]
    * Редактирование информации о лоте до начала торгов.
* **Участники торгов:**
    * Регистрация и аутентификация пользователей.
    * Разделение ролей: Покупатель, Продавец (с функциями Менеджера аукциона), Системный Администратор.
* **Процесс торгов:**
    * Возможность для покупателей делать ставки на активные лоты.
    * Фиксация текущей цены и лидирующего участника.
    * Применение правила: покупатель на одном аукционе может купить только один предмет. [cite: 6]
* **Результаты аукциона:**
    * Фиксация фактической цены продажи и данных покупателя после завершения аукциона. [cite: 6]
* **Ролевая модель и доступ:**
    * **Покупатель:** Просмотр аукционов/лотов, размещение ставок. [cite: 2]
    * **Продавец (включая функции Менеджера аукциона):** Выставление своих лотов, управление своими лотами, создание и управление аукционами (старт, завершение, редактирование), модерация лотов. [cite: 2]
    * **Системный Администратор:** Управление пользователями (блокировка, изменение доступных бизнес-ролей), доступ к отчетам.
    * При входе пользователь (кроме системного администратора) выбирает активную роль на текущую сессию.
* **Отчеты и списки ("Запросы" и "Обобщенные списки" из Задания №33):**
    * Сведения о продавцах, покупателях, аукционах. [cite: 7]
    * Сведения о предметах для продажи (с фильтром по дате за месяц). [cite: 8]
    * Предметы на заданную дату и на заданном аукционе. [cite: 10]
    * Аукционы по заданной специфике. [cite: 11]
    * Предмет с максимальной разницей между начальной и конечной ценами. [cite: 10]
    * Аукцион с максимальным числом проданных предметов. [cite: 12]
    * Покупатель и продавец самого дорогого лота. [cite: 10]
    * И другие отчеты, реализованные в системе.

## Технологический стек

* **Бэкенд:** Go (Golang), Gin (веб-фреймворк), GORM (ORM), PostgreSQL (база данных), JWT (аутентификация).
* **Фронтенд:** React.js, React Router DOM, Axios, Context API.
* **База данных:** PostgreSQL.
* **Контейнеризация:** Docker, Docker Compose.

## Структура проекта

Проект разделен на две основные части:

* `backend/`: Исходный код бэкенд-приложения на Go.
* `frontend/`: Исходный код фронтенд-приложения на React.

## Запуск проекта

Существует два способа запуска проекта: локально (требует настройки окружения) или с использованием Docker (рекомендуется для простоты и консистентности).

### A. Локальный запуск

**Предварительные требования:**
* Go (версия 1.21+ или указанная в `backend/go.mod`).
* Node.js (версия 18+ рекомендуется) и npm или yarn.
* Работающий сервер PostgreSQL.

**1. Настройка PostgreSQL:**
   * Создайте базу данных, например, `auction_db`.
   * Создайте пользователя (например, `auction_user` с паролем `auction_password`) и предоставьте ему все права на созданную базу данных. Пример команд для psql (выполнять под суперпользователем postgres):
     ```sql
     CREATE DATABASE auction_db;
     CREATE USER auction_user WITH PASSWORD 'auction_password';
     ALTER DATABASE auction_db OWNER TO auction_user; 
     ```
     Если `auction_user` является владельцем БД, то права на схему `public` обычно есть. Если нет, их нужно выдать явно, как показано в закомментированной строке (выполнять под владельцем БД или суперпользователем).

**2. Настройка Бэкенда:**
   * Перейдите в директорию `backend/`.
   * Создайте файл `.env` в директории `backend/` (на основе `backend/config/config.go` или примера ниже) или установите соответствующие переменные окружения:
     ```env
     DB_HOST=localhost
     DB_PORT=5432 # или ваш порт PostgreSQL
     DB_USER=auction_user # или ваш пользователь PostgreSQL
     DB_PASSWORD=auction_password # или ваш пароль
     DB_NAME=auction_db
     SERVER_PORT=8080
     JWT_SECRET=your-very-strong-and-long-secret-key-for-jwt # ОБЯЗАТЕЛЬНО ЗАМЕНИТЕ!
     JWT_EXPIRES_IN_HOURS=72
     ```
   * Выполните команду для запуска бэкенда:
     ```bash
     go run cmd/main.go
     ```
     Бэкенд будет доступен по адресу `http://localhost:8080`. При первом запуске он должен создать таблицы в БД и пользователя `sysadmin@auction.app`.

**3. Настройка Фронтенда:**
   * Перейдите в директорию `frontend/`.
   * Установите зависимости:
     ```bash
     npm install
     ```
   * Убедитесь, что в `frontend/src/services/apiClient.js` переменная `API_BASE_URL` указывает на ваш запущенный бэкенд (`http://localhost:8080/api/v1`).
   * Запустите фронтенд:
     ```bash
     npm start
     ```
     Фронтенд будет доступен по адресу `http://localhost:3000`.

### B. Запуск с использованием Docker

**Предварительные требования:**
* Установленный и запущенный Docker Desktop (или Docker Engine и Docker Compose).

**1. Конфигурация:**
   * Убедитесь, что в файле `Auction/docker-compose.yml` в секции `environment` для сервиса `backend` указан надежный `JWT_SECRET`.
   * Пользователь и база данных PostgreSQL (`auction_user`, `auction_password`, `auction_db`) будут созданы автоматически при первом запуске Docker Compose на основе переменных окружения в `docker-compose.yml`.

**2. Сборка и запуск:**
   * Откройте терминал в **корневой директории проекта** (`Auction/`, где находится `docker-compose.yml`).
   * Выполните команду:
     ```bash
     docker-compose up --build
     ```
     Для запуска в фоновом режиме используйте:
     ```bash
     docker-compose up --build -d
     ```
   * При первом запуске Docker загрузит образы, соберет ваши приложения и создаст базу данных. Бэкенд выполнит миграции и создаст системного администратора.

**3. Доступ к приложению:**
   * Фронтенд: `http://localhost:3000`
   * Бэкенд API (для прямого доступа, если нужно): `http://localhost:8080/api/v1`
   * PostgreSQL будет доступен на `localhost:5432` (если вы захотите подключиться к нему через DBeaver или другой клиент, используйте учетные данные `auction_user`/`auction_password` из `docker-compose.yml`).

**Остановка контейнеров:**
   * В консоли, где запущен `docker-compose up`, нажмите `Ctrl+C`.
   * Чтобы остановить и удалить контейнеры:
     ```bash
     docker-compose down
     ```
   * Чтобы остановить, удалить контейнеры и тома (включая данные БД PostgreSQL):
     ```bash
     docker-compose down -v
     ```

## Учетные данные по умолчанию